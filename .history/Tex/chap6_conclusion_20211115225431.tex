\chapter{总结与展望}\label{chap:conclusion}

% 结论是对论文主要研究结果、论点的提炼与概括，应精炼、准确、完整，使读者看后能全面了解论文的意义、目的和工作内容。结论应包括论文的核心观点，主要阐述作者的创造性工作及所取得的研究成果在本领域中的地位、作用和意义，交代研究工作的局限，提出未来工作的意见或建议。

本论文关注的是利用机器学习探索时间序列数据。因为机器学习能够较为精确地从大量数据中提取关键信息，因此受到了国内外学术界和工业界越来越多的关注。鉴于机器学习从数据中提取关键信息的优异性能，本论文基于太阳黑子（一类特征）、泉流量（两类特征）、地震数值模拟（多类特征）等时间序列问题展开研究。针对“太阳黑子”，本论文基于神经网络探测未来不同时间窗口长度的太阳黑子强度，这里重点关注第25太阳周的太阳黑子峰值；针对“泉流量”，本论文基于多种机器学习模型预测未来不同时期龙子祠泉流量变化趋势；针对“地震数值模拟”，本论文选取了南加州地区作为研究对象，预测未来最大震级。具体内容为：
\begin{enumerate}
  \item[(1)] \textbf{基于神经网络预测太阳黑子活动}。太阳黑子是太阳活动过程中很容易观测到的特征。太阳内部的强磁场导致太阳黑子的产生，太阳黑子能够反映太阳活动的剧烈程度。目前有关太阳黑子记录长达400余年，长期的记录为理解太阳活动机制奠定了基础。太阳黑子的时间序列数据具有非平稳性、非高斯性和非线性等特征，目前预测太阳黑子活动始终具有挑战性。已有研究利用年均或月均太阳黑子数量或面积预测未来太阳黑子活动，但针对未来第25太阳周太阳黑子的峰值与过去太阳周的峰值相比是上升还是下降，目前的研究并未给出一致的结论。传统意义上的基于物理机制的模型在拟合太阳黑子活动时会刻意简化模型，从而难以准确捕获太阳黑子时间序列关系。这里采用月均太阳黑子数量和面积（这里的面积是指太阳黑子占太阳可见半球的面积），采纳了不同的输入时间窗口长度和输出时间窗口长度，输入时间窗口长度选择了72个月（6年）、132个月（11年）和264个月（22年），输出时间窗口长度选择了1个月和72个月，基于不同结构的神经网络（LSTM-RNN、1DCNN和LSTM-1DCNN），分别进行预测和对照分析。
  \begin{itemize}
    \item[(a)] \textbf{讨论输出时间窗口长度为1个月的太阳黑子强度}。
    \begin{itemize}
      \item[$\circ$] \textbf{太阳黑子数}。历史72个月作为输入时间窗口长度所得到的模型均是最优的。LSTM-RNN的拟合指标MSE=$0.0030$，RMSE=$0.0548$，预测2021年9月太阳黑子数为$38.87$；1DCNN的拟合指标MSE=$0.0041$，RMSE=$0.0640$，预测2021年9月太阳黑子数为$31.66$；LSTM-1DCNN的拟合指标MSE=$0.0029$，RMSE=$0.0543$，预测2021年9月太阳黑子数为$40.97$。
      \item[$\circ$] \textbf{太阳黑子面积}。当输入时间窗口长度为72个月，LSTM-RNN的拟合指标MSE=\\$0.0021$，RMSE=$0.0454$，预测2021年9月太阳黑子面积为$274.14$；当输入时间窗口长度为132个月，1DCNN的拟合指标MSE=$0.0028$，RMSE=$0.0531$，预测2021年9月太阳黑子面积为$359.78$；当输入时间窗口长度为132个月，LSTM-1DCNN的拟合指标MSE=$0.0021$，RMSE=$0.0453$，预测2021年9月太阳黑子面积为$288.61$。
    \end{itemize}
    \item[(b)] \textbf{讨论输出时间窗口长度为72个月的最大太阳黑子强度}。
    \begin{itemize}
      \item[$\circ$] \textbf{太阳黑子数}。这里将预测的未来72个月最大太阳黑子强度作为第25太阳周太阳黑子的峰值。历史264个月作为输入时间窗口长度所得到的模型均是最优的。3层最佳的LSTM-1DCNN的拟合指标MSE=$0.0085$，RMSE=$0.0920$，预测未来72个月太阳黑子数最大值为$151.55$，发生在2023年9月；4层最佳的LSTM-1DCNN的拟合指标MSE=$0.0082$，RMSE=$0.0905$，预测未来72个月太阳黑子数最大值为$174.71$，发生在2025年1月；5层最佳的LSTM-1DCNN的拟合指标MSE=$0.0072$，RMSE=$0.0849$，预测未来72个月太阳黑子数最大值为$132.86$，发生在2024年12月。对黑子数而言，第23太阳周最大太阳黑子数出现在2001年9月，其值为238.2；第24太阳周最大太阳黑子数出现在2014年2月，其值为146.1。研究结果显示，第25太阳周的峰值跟第24太阳周基本持平。 
      \item[$\circ$] \textbf{太阳黑子面积}。历史132个月作为输入时间窗口长度所得到的模型均是最优的。3层最佳的LSTM-1DCNN的拟合指标MSE=$0.0078$，RMSE=$0.0884$，预测未来72个月太阳黑子面积最大值为$1016.32$，发生在2024年8月；4层最佳的LSTM-1DCNN的拟合指标MSE=$0.0082$，RMSE=$0.0905$，预测未来72个月太阳黑子面积最大值为$1469.01$，发生在2025年3月；5层最佳的LSTM-1DCNN的拟合指标MSE=$0.0072$，RMSE=$0.0849$，预测未来72个月太阳黑子面积最大值为$1397.77$，发生在2024年4月。对于太阳黑子面积，第23太阳周MSSA的峰值为2171.7，出现在2001年9月；第24太阳周MSSA的峰值为1439.82，出现在2014年2月。研究结果显示，第25太阳周的峰值跟第24太阳周基本持平。 
    \end{itemize}
  \end{itemize}
  
  经过多次试验后，发现模型的性能并不会随着输入时间窗口长度的增加而逐渐提高。也就是说，输入时间窗口长度存在一个范围，超出该范围时模型性能会有所下降。另外，本研究还发现输出时间窗口长度增加会降低模型的性能，可能的原因是长期来看，时间序列很容易受到外界其他因素的干扰。

  \item[(2)] \textbf{利用机器学习预测龙子祠泉流量变化}。预测太阳黑子活动时只考虑了一种特征，探测泉流量变化时我们试图增加输入特征。目前，人类经济活动致使全球气候变得愈加不稳定，人口的增加又迫使生活用水和农业用水需求的激增。全球大部分未冻结的淡水都存储在地下含水层中，地下水的可持续利用有助于人类经济和社会的稳定发展。然而，近些年来，地下水过度开采，井水干枯、溪流和湖泊等淡水区的水量减少、抽水成本日益增加、地面沉降、供水不足等现象时有发生。泉流量是地下水到地表水过渡的指标之一，反映了含水层的动态变化。准确预知泉流量的变化，优化泉水的利用效率，保持合理的农业用水，有助于整个水源的可持续管理。泉流量是一系列动态变化的结果，整个泉域可看作是一个非线性的复杂系统，因为地下水流途径错综复杂。一般来讲，对于泉流量的定量分析需要考虑水文地质特征、地貌特征、土地利用、土地覆盖、人为开采和气候条件等，但这些特征的数据难以收集。
  
  这里研究对象为龙子祠泉，数据涵盖了龙子祠泉流量、其周围九个区域（即化乐、克城、山头、一平垣、台头、光华、河底、双风渰、关王庙）的降水量。龙子祠泉是具有喀斯特地貌的泉域。喀斯特地貌是指地下水和地表水对可溶性岩石腐蚀与沉淀、侵蚀与沉积以及重力崩塌、坍塌、堆积等作用形成的地貌。在溶洞中，地下管道多，水流会形成一个不断扩大的循环网。理论上，基于平衡方程模型可估计未来泉流量。但在实际应用过程中，会经常简化分析。
      
  本论文基于不同的机器学习模型在预测时间窗口长度不超过4个月的情况下预测泉流量并进行比较分析。经过分析后，将输入和输出时间窗口长度分别设置为1至4个月。将不同时间窗口长度的输入数据和输出数据喂给不同的机器学习模型，这些模型包括LSTM-RNN、1DCNN、LSTM-1DCNN、SVR、LR、RF、DT和KNN。
  
  \begin{itemize}
    \item[$\circ$] \textbf{输出窗口为1个月}。当输入时间窗口长度为1个月时，LSTM-1DCNN的拟合指标MSE=$\SI{0.0009}{m^{3}/s}$，RMSE=$\SI{0.0297}{m^{3}/s}$，预测2019年1月泉流量为$\SI{2.97}{m^{3}/s}$；当输入时间窗口长度为2个月时，1DCNN的拟合指标MSE=$\SI{0.0008}{m^{3}/s}$，RMSE=\\$\SI{0.0288}{m^{3}/s}$，预测2019年1月泉流量为$\SI{2.92}{m^{3}/s}$；当输入时间窗口长度为3个月时，RF的拟合指标MSE=$\SI{0.0010}{m^{3}/s}$，RMSE=$\SI{0.0313}{m^{3}/s}$，预测2019年1月泉流量为$\SI{2.99}{m^{3}/s}$；当输入时间窗口长度为4个月时，RF的拟合指标MSE=$\SI{0.0010}{m^{3}/s}$，RMSE=$\SI{0.0319}{m^{3}/s}$，预测2019年1月泉流量为$\SI{2.99}{m^{3}/s}$。另外，多数模型在测试集和其观测值上存在1个月的滞后。
    \item[$\circ$] \textbf{输出窗口为2个月}。当输入时间窗口长度为1个月时，1DCNN的拟合指标MSE=\\$\SI{0.0012}{m^{3}/s}$，RMSE=$\SI{0.0352}{m^{3}/s}$，预测2019年1月泉流量为$\SI{2.93}{m^{3}/s}$，2019年2月泉流量为$\SI{2.94}{m^{3}/s}$；当输入时间窗口长度为2个月时，SVR的拟合指标MSE=\\$\SI{0.0013}{m^{3}/s}$，RMSE=$\SI{0.0360}{m^{3}/s}$，预测2019年1月泉流量为$\SI{2.98}{m^{3}/s}$，预测2019年2月泉流量为$\SI{2.91}{m^{3}/s}$；当输入时间窗口长度为3个月时，RF的拟合指标MSE=$\SI{0.0013}{m^{3}/s}$，RMSE=$\SI{0.0363}{m^{3}/s}$，预测2019年1月泉流量为$\SI{2.99}{m^{3}/s}$，2019年2月泉流量为$\SI{2.93}{m^{3}/s}$；当输入时间窗口长度为4个月时，RF的拟合指标MSE=$\SI{0.0014}{m^{3}/s}$，RMSE=$\SI{0.0373}{m^{3}/s}$，预测2019年1月泉流量为$\SI{3.05}{m^{3}/s}$，预测2019年2月泉流量为$\SI{3.07}{m^{3}/s}$。另外，多数模型在测试集和其观测值上存在2个月的滞后。
    \item[$\circ$] \textbf{输出窗口为3个月}。当输入时间窗口长度为1个月时，LSTM-1DCNN的拟合指标MSE=$\SI{0.0015}{m^{3}/s}$，RMSE=$\SI{0.0389}{m^{3}/s}$，预测2019年1月泉流量为$\SI{2.98}{m^{3}/s}$，2019年2月泉流量为$\SI{2.98}{m^{3}/s}$，2019年3月泉流量为$\SI{2.89}{m^{3}/s}$；当输入时间窗口长度为2个月时，SVR的拟合指标MSE=$\SI{0.0013}{m^{3}/s}$，RMSE=$\SI{0.0360}{m^{3}/s}$，预测2019年1月泉流量为$\SI{2.98}{m^{3}/s}$，2019年2月泉流量为$\SI{2.91}{m^{3}/s}$，2019年3月泉流量为$\SI{2.90}{m^{3}/s}$；当输入时间窗口长度为3个月时，LSTM-RNN的拟合指标MSE=$\SI{0.0015}{m^{3}/s}$，RMSE=$\SI{0.0390}{m^{3}/s}$，预测2019年1月泉流量为$\SI{3.03}{m^{3}/s}$，2019年2月泉流量为$\SI{3.04}{m^{3}/s}$，2019年3月泉流量为$\SI{2.98}{m^{3}/s}$；当输入时间窗口长度为4个月时，RF的拟合指标MSE=$\SI{0.0017}{m^{3}/s}$，RMSE=$\SI{0.0414}{m^{3}/s}$，预测2019年1月泉流量为$\SI{3.06}{m^{3}/s}$，2019年2月泉流量为$\SI{3.07}{m^{3}/s}$，2019年3月泉流量为$\SI{2.99}{m^{3}/s}$。另外，多数模型在测试集和其观测值上存在3个月的滞后。
    \item[$\circ$] \textbf{输出窗口为4个月}。当输入时间窗口长度为1个月时，SVR的拟合指标MSE=\\$\SI{0.0019}{m^{3}/s}$，RMSE=$\SI{0.0433}{m^{3}/s}$，预测2019年1月泉流量为$\SI{2.97}{m^{3}/s}$，2019年2月泉流量为$\SI{2.91}{m^{3}/s}$，2019年3月泉流量为$\SI{2.91}{m^{3}/s}$，2019年4月泉流量为$\SI{2.90}{m^{3}/s}$；当输入时间窗口长度为2个月时，SVR的拟合指标MSE=$\SI{0.0018}{m^{3}/s}$，RMSE=$\SI{0.0424}{m^{3}/s}$，预测2019年1月泉流量为$\SI{2.98}{m^{3}/s}$，2019年2月泉流量为$\SI{2.91}{m^{3}/s}$，2019年3月泉流量为$\SI{2.90}{m^{3}/s}$，2019年4月泉流量为$\SI{2.93}{m^{3}/s}$；当输入时间窗口长度为3个月时，SVR的拟合指标MSE=$\SI{0.0020}{m^{3}/s}$，RMSE=$\SI{0.0448}{m^{3}/s}$，预测2019年1月泉流量为$\SI{2.30}{m^{3}/s}$，2019年2月泉流量为$\SI{2.91}{m^{3}/s}$，2019年3月泉流量为$\SI{2.83}{m^{3}/s}$，2019年4月泉流量为$\SI{2.78}{m^{3}/s}$；当输入时间窗口长度为4个月时，RF的拟合指标MSE=$\SI{0.0022}{m^{3}/s}$，RMSE=$\SI{0.0468}{m^{3}/s}$，预测2019年1月泉流量为$\SI{3.07}{m^{3}/s}$，2019年2月泉流量为$\SI{3.01}{m^{3}/s}$，2019年3月泉流量为$\SI{2.97}{m^{3}/s}$，2019年4月泉流量为$\SI{2.93}{m^{3}/s}$。另外，多数模型在测试集和其观测值上存在4个月的滞后。
    \item[$\circ$] \textbf{讨论输入时间窗口长度为1个月且输入中仅含有历史泉流量的情况}。LSTM-RNN的拟合指标MSE=$\SI{0.0009}{m^{3}/s}$，RMSE=$\SI{0.0297}{m^{3}/s}$，预测2019年1月泉流量为$\SI{2.98}{m^{3}/s}$；SVR的拟合指标MSE=$\SI{0.0009}{m^{3}/s}$，RMSE=$\SI{0.0297}{m^{3}/s}$，预测2019年1月泉流量为$\SI{2.97}{m^{3}/s}$；LR的拟合指标MSE=$\SI{0.0009}{m^{3}/s}$，RMSE=$\SI{0.0306}{m^{3}/s}$，预测2019年1月泉流量为$\SI{3.01}{m^{3}/s}$；RF的拟合指标MSE=$\SI{0.0014}{m^{3}/s}$，RMSE=\\$\SI{0.0374}{m^{3}/s}$，预测2019年1月泉流量为$\SI{2.94}{m^{3}/s}$；DT的拟合指标MSE=$\SI{0.0017}{m^{3}/s}$，RMSE=$\SI{0.0409}{m^{3}/s}$，预测2019年1月泉流量为$\SI{2.97}{m^{3}/s}$；KNN的拟合指标MSE=$\SI{0.0015}{m^{3}/s}$，RMSE=$\SI{0.0388}{m^{3}/s}$，预测2019年1月泉流量为$\SI{2.91}{m^{3}/s}$。 
  \end{itemize}
    
  总体来看，八类不同模型的性能评价指标（MSE和RMSE）都偏小，因此几种方法都适合预测未来泉流量变化。输入时间窗口长度从1个月增加到4个月会逐渐降低模型的预测能力，这在某种程度上说明了输入数据存在一定程度上的冗余，这些冗余信息会在拟合过程中被忽视。随着输出时间窗口长度的增加，模型的性能会出现一定幅度的下降。这里输入和输出时间窗口长度对预测泉流量的模型性能的影响同研究太阳黑子类似，即需要找到合适的输入时间窗口长度，而输出时间窗口长度则在目标时间内越短越好。另外，进一步研究发现，仅仅利用历史1个月泉流量就能精确预测未来1个月龙子祠泉流量，可能是因为降水量随季节变化，而模型学到了泉流量随季节变化的特征。

  泉流量不仅受到历史泉流量的影响，还会受到其他因素的干扰，比如地下水开采量、入渗、地表径流、蒸散、地下水补给、土壤水分、侧向水流至蓄水层、地表含水层和地下含水层之间的渗漏、蓄水层中蓄水量的变化等。这些因素均没有被考虑到模型中。导致所学到的模型总会出现一定程度的偏差。未来机器学习应用于泉流量可能的研究方向为：（1）研究对象为龙子祠泉，可以尝试其他研究区域，进一步验证模型是否具备普适性；（2）减小采样间隔时间，查看能否进一步提高模型的性能。

  \item[(3)] \textbf{基于机器学习对南加州地区的地震进行中期预报}。因地震发生机制极其复杂，这里我们试图使用多种输入特征预报地震。大震发生很可能会导致严重的人员伤亡和经济损失，影响社会经济的持续发展。为了减小这些损失，预报强震就显得尤为重要。地震预报一般会涉及到时间、地点、震级、可能发生的概率这几个要素。根据预报的时间长度，地震预报分为长期、中期和短期预报。其中，短期预报不可控因素太多，这里不予以考虑。长期预报需要的观测资料至少上百年，目前数据时长不够。因此，地震中期预报成为关注的重点。地震数据来源于美国南加州地区地震目录。从地震目录中计算了16种不同的地震因子，采用不同机器学习方法（LSTM-RNN、SVR、LR、RF、DT、KN、GBRT、ETR）对区域内可能发生的最大震级进行了以下几种试验：
  \begin{itemize}
    \item[(a)] 基于时空窗口滑动法将研究区域划分为6个不同区块，数据集划分比例为0.8：0.2，预报未来一年的最大震级。
    \item[(b)] 基于整个区块，数据集划分比例为0.8：0.2，预报未来一年的最大震级。
    \item[(c)] 基于整个区块，数据集划分比例分别为0.8：0.2、0.85：0.15和0.9：0.1，预报未来十年的最大震级。
  \end{itemize}
    
  从多数模型的表现来看，它们均出现了很大程度的过拟合问题。当基于整个区块且划分比例为0.9：0.1时，LSTM-RNN、SVR、LR均出现了欠拟合状态，RF、GBRT、DT、KNN、ETR均出现了过拟合状态。尽管在这种情况下试验是最优的，但模型极易受到数据集的影响，即数据集的微小变化对模型的性能会产生巨大的影响，即模型产生了高方差。这种情况出现的原因可能是选取的数据集长度不够或忽略了某些重要的输入特征。另外，本研究缺乏对多个地区、多种类型、多种形式的地震目录进行尝试，未来可进一步探索以多种前兆观测资料与地震目录相结合的方法，更深入地研究中期地震预报问题。

\end{enumerate}